<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Page Demo - 42 Webserv</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        .error-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .error-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            background-color: #f5f5f5;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .error-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .error-card h3 {
            margin-top: 0;
            color: #d32f2f;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 10px;
        }

        .error-card p {
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .error-card a {
            display: inline-block;
            padding: 8px 15px;
            background-color: #f44336;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .error-card a:hover {
            background-color: #d32f2f;
        }

        .status-info {
            margin-top: 10px;
            font-size: 0.85rem;
            color: #666;
        }

        .test-area {
            background-color: #e8eaf6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }

        .test-area h3 {
            margin-top: 0;
        }

        .test-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 500px;
        }

        .test-form label {
            font-weight: bold;
        }

        .test-form input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .test-form button {
            padding: 10px 15px;
            background-color: #3f51b5;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .test-form button:hover {
            background-color: #303f9f;
        }
    </style>
</head>
<body>
    <header>
        <h1>Error Pages Demonstration</h1>
        <p>Test Webserv's custom error handling capabilities</p>
    </header>

    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/images/">Images</a></li>
            <li><a href="/docs/">Documents</a></li>
            <li><a href="/docs/about.html">About</a></li>
        </ul>
    </nav>

    <div class="container">
        <main>
            <section class="blog-post">
                <h2>Error Handling in Webserv</h2>
                <p>
                    One of the key features of our Webserv implementation is custom error handling.
                    HTTP servers need to gracefully handle various error conditions and return
                    appropriate status codes and error pages to clients.
                </p>
                <p>
                    This demonstration page allows you to test various error scenarios and see how
                    our server responds with custom error pages. Click on any of the error buttons
                    below to intentionally trigger that error.
                </p>
            </section>

            <section class="error-grid">
                <div class="error-card">
                    <h3>404 Not Found</h3>
                    <p>This error occurs when the requested resource cannot be found on the server.</p>
                    <a href="/this-page-does-not-exist">Trigger 404 Error</a>
                    <div class="status-info">Status Code: 404 Not Found</div>
                </div>

                <div class="error-card">
                    <h3>403 Forbidden</h3>
                    <p>This error occurs when the server understands the request but refuses to authorize it.</p>
                    <a href="/forbidden-area">Trigger 403 Error</a>
                    <div class="status-info">Status Code: 403 Forbidden</div>
                </div>

                <div class="error-card">
                    <h3>400 Bad Request</h3>
                    <p>This error occurs when the server cannot process the request due to a client error.</p>
                    <a href="/trigger-bad-request">Trigger 400 Error</a>
                    <div class="status-info">Status Code: 400 Bad Request</div>
                </div>

                <div class="error-card">
                    <h3>405 Method Not Allowed</h3>
                    <p>This error occurs when the request method is not supported for the requested resource.</p>
                    <a href="javascript:void(0);" onclick="sendPutRequest()">Trigger 405 Error</a>
                    <div class="status-info">Status Code: 405 Method Not Allowed</div>
                </div>

                <div class="error-card">
                    <h3>413 Payload Too Large</h3>
                    <p>This error occurs when the request entity is larger than limits defined by server.</p>
                    <a href="/upload-large-file">Trigger 413 Error</a>
                    <div class="status-info">Status Code: 413 Payload Too Large</div>
                </div>

                <div class="error-card">
                    <h3>500 Internal Server Error</h3>
                    <p>This error occurs when the server has encountered a situation it doesn't know how to handle.</p>
                    <a href="/trigger-server-error">Trigger 500 Error</a>
                    <div class="status-info">Status Code: 500 Internal Server Error</div>
                </div>

                <div class="error-card">
                    <h3>501 Not Implemented</h3>
                    <p>This error occurs when the server does not support the functionality required to fulfill the request.</p>
                    <a href="javascript:void(0);" onclick="sendCustomRequest()">Trigger 501 Error</a>
                    <div class="status-info">Status Code: 501 Not Implemented</div>
                </div>

                <div class="error-card">
                    <h3>503 Service Unavailable</h3>
                    <p>This error occurs when the server is not ready to handle the request.</p>
                    <a href="/unavailable-service">Trigger 503 Error</a>
                    <div class="status-info">Status Code: 503 Service Unavailable</div>
                </div>
            </section>

            <section class="test-area">
                <h3>Test Custom URL</h3>
                <p>Enter a custom path to test how the server handles specific URLs:</p>
                <form class="test-form" id="custom-url-form">
                    <div>
                        <label for="custom-path">Enter path (e.g., /this/does/not/exist):</label>
                        <input type="text" id="custom-path" placeholder="/path/to/test" required>
                    </div>
                    <button type="submit">Test Path</button>
                </form>
            </section>

            <section class="test-area">
                <h3>Upload Size Test</h3>
                <p>Test the server's file size limitations:</p>
                <form class="test-form" action="/upload-test" method="POST" enctype="multipart/form-data">
                    <div>
                        <label for="large-file">Select a large file to test size limits:</label>
                        <input type="file" id="large-file" name="large-file">
                    </div>
                    <button type="submit">Upload File</button>
                    <p><small>Note: The server may reject files over its configured size limit with a 413 error.</small></p>
                </form>
            </section>
        </main>

        <aside>
            <section class="sidebar-section">
                <h3>HTTP Status Codes</h3>
                <ul>
                    <li><strong>4xx</strong> - Client errors</li>
                    <li><strong>5xx</strong> - Server errors</li>
                </ul>
                <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" target="_blank">Learn more about HTTP status codes</a></p>
            </section>

            <section class="sidebar-section">
                <h3>Error Page Features</h3>
                <p>Our custom error pages include:</p>
                <ul>
                    <li>Clear error identification</li>
                    <li>Helpful troubleshooting info</li>
                    <li>Navigation back to safe pages</li>
                    <li>Consistent design with the main site</li>
                </ul>
            </section>

            <section class="sidebar-section">
                <h3>Error Logs</h3>
                <p>All errors are logged by the server for monitoring and debugging purposes.</p>
                <p>Server administrators can access these logs to investigate issues.</p>
            </section>
        </aside>
    </div>

    <footer>
        <p>&copy; 2023 42 Webserv Project - Created by a team of three 42 students</p>
    </footer>

    <script>
        // Function to send a PUT request to trigger a 405 error
        function sendPutRequest() {
            fetch('/method-not-allowed', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ test: 'data' })
            })
            .then(response => {
                window.location.href = response.url;
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }

        // Function to send a custom method request to trigger a 501 error
        function sendCustomRequest() {
            const xhr = new XMLHttpRequest();
            xhr.open('CUSTOM_METHOD', '/not-implemented', true);
            xhr.onload = function() {
                window.location.reload();
            };
            xhr.onerror = function() {
                window.location.reload();
            };
            xhr.send();
        }

        // Custom URL form handler
        document.getElementById('custom-url-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const path = document.getElementById('custom-path').value;
            window.location.href = path;
        });
    </script>
</body>
</html>